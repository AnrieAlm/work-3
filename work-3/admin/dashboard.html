<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Dashboard - Borislav Korabev</title>
    <link rel="stylesheet" href="admin-styles.css">
</head>
<body>
    <header class="admin-header">
        <div class="header-content">
            <h1>ADMIN DASHBOARD</h1>
            <div class="header-actions">
                <a href="project-editor.html?action=create" class="btn-add">+ ADD PROJECT</a>
                <a href="site-settings.html" class="btn-settings">SETTINGS</a>
                <button id="logoutBtn" class="btn-logout">LOGOUT</button>
            </div>
        </div>
    </header>

    <main class="dashboard-main">
        <div class="dashboard-stats">
            <div class="stat-card">
                <span class="stat-number" id="totalProjects">0</span>
                <span class="stat-label">Total Projects</span>
            </div>
            <div class="stat-card">
                <span class="stat-number" id="publishedCount">0</span>
                <span class="stat-label">Published</span>
            </div>
            <div class="stat-card">
                <span class="stat-number" id="draftCount">0</span>
                <span class="stat-label">Drafts</span>
            </div>
        </div>

        <h2 class="section-title">All Projects</h2>
        <div class="dashboard-grid" id="projectsGrid">
            <!-- Projects will be loaded here dynamically -->
        </div>
    </main>

    <footer class="admin-footer">
        <p>&copy; 2026 Borislav Korabev. Admin Panel.</p>
    </footer>

    <script src="crud.js"></script>
    <script src="admin.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            checkLoginStatus();
            loadProjects();
            loadStats();
        });

        function loadStats() {
            const projects = getProjects();
            const published = projects.filter(p => p.status === 'published').length;
            const drafts = projects.filter(p => p.status === 'draft').length;
            
            document.getElementById('totalProjects').textContent = projects.length;
            document.getElementById('publishedCount').textContent = published;
            document.getElementById('draftCount').textContent = drafts;
        }

        function loadProjects() {
            const projectsGrid = document.getElementById('projectsGrid');
            const projects = getProjects();
            
            if (projects.length === 0) {
                projectsGrid.innerHTML = `
                    <div class="empty-state">
                        <p>No projects found.</p>
                        <a href="project-editor.html?action=create" class="btn-primary">Create Your First Project</a>
                    </div>
                `;
                return;
            }

            projectsGrid.innerHTML = projects.map(project => `
                <div class="dashboard-card project-card-item" data-id="${project.id}">
                    <div class="project-card-header">
                        <h2>${project.title}</h2>
                        <span class="project-status-badge ${project.status}">${project.status.toUpperCase()}</span>
                    </div>
                    <div class="project-card-image">
                        <img src="../images/${project.image}" alt="${project.title}" onerror="this.src='placeholder.png'">
                    </div>
                    <p class="project-card-description">${project.description}</p>
                    <div class="project-card-actions">
                        <a href="project-editor.html?action=edit&id=${project.id}" class="btn-action">
                            <span class="btn-icon">‚úèÔ∏è</span> Edit
                        </a>
                        <button class="btn-action delete-project" data-id="${project.id}">
                            <span class="btn-icon">üóëÔ∏è</span> Delete
                        </button>
                    </div>
                </div>
            `).join('');

            document.querySelectorAll('.delete-project').forEach(btn => {
                btn.addEventListener('click', () => confirmDelete(btn.dataset.id));
            });
        }

        function confirmDelete(projectId) {
            if (confirm('Are you sure you want to delete this project? This action cannot be undone.')) {
                if (deleteProject(projectId)) {
                    alert('Project deleted successfully!');
                    loadProjects();
                    loadStats();
                } else {
                    alert('Failed to delete project.');
                }
            }
        }
    </script>
</body>
</html>